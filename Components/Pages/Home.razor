@page "/"
@inject HttpClient Http

<PageTitle>Home</PageTitle>

<div class="kanban-board">
	<KanbanColumn Title="A Fazer">
		@foreach (var tarefa in TarefasA)
		{
			<KanbanCard Title="@tarefa.Titulo" Description="@tarefa.Descricao"></KanbanCard>
		}
	</KanbanColumn>

	<KanbanColumn Title="Fazendo">
		@foreach (var tarefa in TarefasF)
		{
			<KanbanCard Title="@tarefa.Titulo" Description="@tarefa.Descricao"></KanbanCard>
		}
	</KanbanColumn>

	<KanbanColumn Title="Finalizado">
		@foreach (var tarefa in TarefasFin)
		{
			<KanbanCard Title="@tarefa.Titulo" Description="@tarefa.Descricao"></KanbanCard>
		}
	</KanbanColumn>
</div>

@code {
	private List<Tarefa> TarefasA = new();
	private List<Tarefa> TarefasF = new();
	private List<Tarefa> TarefasFin = new();

	protected override async Task OnInitializedAsync()
	{
		// Chama a API para buscar as tarefas
		var tarefas = await Http.GetFromJsonAsync<List<Tarefa>>("api/tarefas/1"); // Substitua "1" pelo ID do usuário autenticado

		// Filtra as tarefas por status
		TarefasA = tarefas.Where(t => t.Status == "A Fazer").ToList();
		TarefasF = tarefas.Where(t => t.Status == "Fazendo").ToList();
		TarefasFin = tarefas.Where(t => t.Status == "Finalizado").ToList();
	}

	public class Tarefa
	{
		public long Id { get; set; }
		public string Titulo { get; set; }
		public string Descricao { get; set; }
		public string Status { get; set; }
		public DateTime Data { get; set; }
		public long UserId { get; set; }
	}
}